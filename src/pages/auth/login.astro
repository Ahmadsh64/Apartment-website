---
const SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;
const SUPABASE_KEY = import.meta.env.VITE_SUPABASE_ANON_KEY;
---
<html lang="he">
  <head><meta charset="utf-8" /><title>Login</title></head>
  <body>
    <h1>Login</h1>
    <form id="loginForm">
      <label>אימייל: <input name="email" type="email" required /></label><br/>
      <label>סיסמה: <input name="password" type="password" required /></label><br/>
      <button type="submit">התחבר</button>
    </form>
    <p>למרשם → <a href="/auth/signup">Signup</a></p>

    <script type="module">
      import { createClient } from 'https://esm.sh/@supabase/supabase-js';
      const SUPABASE_URL = ${JSON.stringify(SUPABASE_URL)};
      const SUPABASE_KEY = ${JSON.stringify(SUPABASE_KEY)};
      const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

      const form = document.getElementById('loginForm');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const fd = new FormData(form);
        const email = fd.get('email');
        const password = fd.get('password');
        const { data, error } = await supabase.auth.signInWithPassword({ email, password });
        if (error) return alert('שגיאה: ' + error.message);
        alert('התחברת בהצלחה');
        location.href = '/admin/add';
      });
    </script>
  </body>
</html>
